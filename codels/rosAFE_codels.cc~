#include "acrosAFE.h"

#include "rosAFE_c_types.h"
#include "genom3_dataFiles.hpp"

/* --- Function AddDependencie ------------------------------------------ */

/** Codel addDependencie of function AddDependencie.
 *
 * Returns genom_ok.
 */
genom_event
addDependencie(char **lowerDep, char **upperDep, rosAFE_flagMap **flagMapSt,
        genom_context self)
{	
  // Transformation to string
  std::string lowerDepS = *lowerDep;
  std::string upperDepS = *upperDep;
  
  // Creation of a flag
  flagStPtr flag ( new flagSt() );
  flag->upperDep = upperDepS;
  flag->lowerDep = lowerDepS;
  flag->waitFlag = true;
	  
  // Storing that flag into the flagMap
  (*flagMapSt)->allFlags.push_back( std::move( flag ) );
  
  return genom_ok;
}


/* --- Function RemoveDependencie --------------------------------------- */

/** Codel removeDependencie of function RemoveDependencie.
 *
 * Returns genom_ok.
 */
genom_event
removeDependencie(char **lowerDep, char **upperDep,
                  rosAFE_flagMap **flagMapSt, genom_context self)
{
  // Transformation to string
  std::string lowerDepS = *lowerDep;
  std::string upperDepS = *upperDep;

  for ( flagStIterator it = (*flagMapSt)->allFlags.begin() ; it != (*flagMapSt)->allFlags.end() ; ++it)
	 if ( ((*it)->upperDep == upperDepS ) && ((*it)->lowerDep == lowerDepS ) )
		(*flagMapSt)->allFlags.erase( it );
		  
  return genom_ok;
}
